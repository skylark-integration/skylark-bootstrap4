{"version":3,"sources":["collapse.js"],"names":["define","langx","$","plugins","bs4","Util","NAME","VERSION","DATA_KEY","EVENT_KEY","jquery_NO_CONFLICT","fn","Default","toggle","parent","DefaultType","Event","SHOW","SHOWN","HIDE","HIDDEN","CLICK_DATA_API","ClassName","COLLAPSE","COLLAPSING","COLLAPSED","Dimension","WIDTH","HEIGHT","Selector","ACTIVES","DATA_TOGGLE","Collapse","[object Object]","element","config","this","_isTransitioning","_element","_config","_getConfig","_triggerArray","slice","call","document","querySelectorAll","id","toggleList","i","len","length","elem","selector","getSelectorFromElement","filterElement","filter","foundElem","_selector","push","_parent","_getParent","_addAriaAndCollapsedClass","hasClass","hide","show","actives","activesData","getAttribute","classList","contains","not","data","startEvent","trigger","isDefaultPrevented","_jqueryInterface","dimension","_getDimension","removeClass","addClass","style","attr","setTransitioning","scrollSize","toUpperCase","transitionDuration","getTransitionDurationFromElement","one","TRANSITION_END","emulateTransitionEnd","getBoundingClientRect","reflow","triggerArrayLength","isTransitioning","removeData","mixin","Boolean","typeCheckConfig","isElement","skylark","utils","dom","query","querySelector","children","each","_getTargetFromElement","triggerArray","isOpen","toggleClass","$this","test","TypeError","on","event","currentTarget","tagName","preventDefault","$trigger","selectors","$target","Constructor","noConflict"],"mappings":"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","file":"../collapse.js","sourcesContent":["define([\n    'skylark-langx/langx',\n    'skylark-utils-dom/query',\n    'skylark-utils-dom/plugins',\n    \"./bs4\",\n    './util'\n], function (langx,$, plugins,bs4,Util) {\n\n    'use strict';\n    const NAME = 'collapse';\n    const VERSION = '4.1.3';\n    const DATA_KEY = 'bs.collapse';\n    const EVENT_KEY = `.${ DATA_KEY }`;\n    const DATA_API_KEY = '.data-api';\n    const jquery_NO_CONFLICT = $.fn[NAME];\n    const Default = {\n        toggle: true,\n        parent: ''\n    };\n    const DefaultType = {\n        toggle: 'boolean',\n        parent: '(string|element)'\n    };\n    const Event = {\n        SHOW: `show${ EVENT_KEY }`,\n        SHOWN: `shown${ EVENT_KEY }`,\n        HIDE: `hide${ EVENT_KEY }`,\n        HIDDEN: `hidden${ EVENT_KEY }`,\n        CLICK_DATA_API: `click${ EVENT_KEY }${ DATA_API_KEY }`\n    };\n    const ClassName = {\n        SHOW: 'show',\n        COLLAPSE: 'collapse',\n        COLLAPSING: 'collapsing',\n        COLLAPSED: 'collapsed'\n    };\n    const Dimension = {\n        WIDTH: 'width',\n        HEIGHT: 'height'\n    };\n    const Selector = {\n        ACTIVES: '.show, .collapsing',\n        DATA_TOGGLE: '[data-toggle=\"collapse\"]'\n    };\n    class Collapse {\n        constructor(element, config) {\n            this._isTransitioning = false;\n            this._element = element;\n            this._config = this._getConfig(config);\n            this._triggerArray = [].slice.call(document.querySelectorAll(`[data-toggle=\"collapse\"][href=\"#${ element.id }\"],` + `[data-toggle=\"collapse\"][data-target=\"#${ element.id }\"]`));\n            const toggleList = [].slice.call(document.querySelectorAll(Selector.DATA_TOGGLE));\n            for (let i = 0, len = toggleList.length; i < len; i++) {\n                const elem = toggleList[i];\n                const selector = Util.getSelectorFromElement(elem);\n                const filterElement = [].slice.call(document.querySelectorAll(selector)).filter(foundElem => foundElem === element);\n                if (selector !== null && filterElement.length > 0) {\n                    this._selector = selector;\n                    this._triggerArray.push(elem);\n                }\n            }\n            this._parent = this._config.parent ? this._getParent() : null;\n            if (!this._config.parent) {\n                this._addAriaAndCollapsedClass(this._element, this._triggerArray);\n            }\n            if (this._config.toggle) {\n                this.toggle();\n            }\n        }\n        static get VERSION() {\n            return VERSION;\n        }\n        static get Default() {\n            return Default;\n        }\n        toggle() {\n            if ($(this._element).hasClass(ClassName.SHOW)) {\n                this.hide();\n            } else {\n                this.show();\n            }\n        }\n        show() {\n            if (this._isTransitioning || $(this._element).hasClass(ClassName.SHOW)) {\n                return;\n            }\n            let actives;\n            let activesData;\n            if (this._parent) {\n                actives = [].slice.call(this._parent.querySelectorAll(Selector.ACTIVES)).filter(elem => {\n                    if (typeof this._config.parent === 'string') {\n                        return elem.getAttribute('data-parent') === this._config.parent;\n                    }\n                    return elem.classList.contains(ClassName.COLLAPSE);\n                });\n                if (actives.length === 0) {\n                    actives = null;\n                }\n            }\n            if (actives) {\n                activesData = $(actives).not(this._selector).data(DATA_KEY);\n                if (activesData && activesData._isTransitioning) {\n                    return;\n                }\n            }\n            const startEvent = $.Event(Event.SHOW);\n            $(this._element).trigger(startEvent);\n            if (startEvent.isDefaultPrevented()) {\n                return;\n            }\n            if (actives) {\n                Collapse._jqueryInterface.call($(actives).not(this._selector), 'hide');\n                if (!activesData) {\n                    $(actives).data(DATA_KEY, null);\n                }\n            }\n            const dimension = this._getDimension();\n            $(this._element).removeClass(ClassName.COLLAPSE).addClass(ClassName.COLLAPSING);\n            this._element.style[dimension] = 0;\n            if (this._triggerArray.length) {\n                $(this._triggerArray).removeClass(ClassName.COLLAPSED).attr('aria-expanded', true);\n            }\n            this.setTransitioning(true);\n            const complete = () => {\n                $(this._element).removeClass(ClassName.COLLAPSING).addClass(ClassName.COLLAPSE).addClass(ClassName.SHOW);\n                this._element.style[dimension] = '';\n                this.setTransitioning(false);\n                $(this._element).trigger(Event.SHOWN);\n            };\n            const capitalizedDimension = dimension[0].toUpperCase() + dimension.slice(1);\n            const scrollSize = `scroll${ capitalizedDimension }`;\n            const transitionDuration = Util.getTransitionDurationFromElement(this._element);\n            $(this._element).one(Util.TRANSITION_END, complete).emulateTransitionEnd(transitionDuration);\n            this._element.style[dimension] = `${ this._element[scrollSize] }px`;\n        }\n        hide() {\n            if (this._isTransitioning || !$(this._element).hasClass(ClassName.SHOW)) {\n                return;\n            }\n            const startEvent = $.Event(Event.HIDE);\n            $(this._element).trigger(startEvent);\n            if (startEvent.isDefaultPrevented()) {\n                return;\n            }\n            const dimension = this._getDimension();\n            this._element.style[dimension] = `${ this._element.getBoundingClientRect()[dimension] }px`;\n            Util.reflow(this._element);\n            $(this._element).addClass(ClassName.COLLAPSING).removeClass(ClassName.COLLAPSE).removeClass(ClassName.SHOW);\n            const triggerArrayLength = this._triggerArray.length;\n            if (triggerArrayLength > 0) {\n                for (let i = 0; i < triggerArrayLength; i++) {\n                    const trigger = this._triggerArray[i];\n                    const selector = Util.getSelectorFromElement(trigger);\n                    if (selector !== null) {\n                        const $elem = $([].slice.call(document.querySelectorAll(selector)));\n                        if (!$elem.hasClass(ClassName.SHOW)) {\n                            $(trigger).addClass(ClassName.COLLAPSED).attr('aria-expanded', false);\n                        }\n                    }\n                }\n            }\n            this.setTransitioning(true);\n            const complete = () => {\n                this.setTransitioning(false);\n                $(this._element).removeClass(ClassName.COLLAPSING).addClass(ClassName.COLLAPSE).trigger(Event.HIDDEN);\n            };\n            this._element.style[dimension] = '';\n            const transitionDuration = Util.getTransitionDurationFromElement(this._element);\n            $(this._element).one(Util.TRANSITION_END, complete).emulateTransitionEnd(transitionDuration);\n        }\n        setTransitioning(isTransitioning) {\n            this._isTransitioning = isTransitioning;\n        }\n        dispose() {\n            $.removeData(this._element, DATA_KEY);\n            this._config = null;\n            this._parent = null;\n            this._element = null;\n            this._triggerArray = null;\n            this._isTransitioning = null;\n        }\n        _getConfig(config) {\n            //config = {\n            //    ...Default,\n            //    ...config\n            //};\n            config = langx.mixin({},Default,config);\n            config.toggle = Boolean(config.toggle);\n            Util.typeCheckConfig(NAME, config, DefaultType);\n            return config;\n        }\n        _getDimension() {\n            const hasWidth = $(this._element).hasClass(Dimension.WIDTH);\n            return hasWidth ? Dimension.WIDTH : Dimension.HEIGHT;\n        }\n        _getParent() {\n            let parent;\n            if (Util.isElement(this._config.parent)) {\n                parent = this._config.parent;\n                if (typeof this._config.parent.skylark-utils-dom/query !== 'undefined') {\n                    parent = this._config.parent[0];\n                }\n            } else {\n                parent = document.querySelector(this._config.parent);\n            }\n            const selector = `[data-toggle=\"collapse\"][data-parent=\"${ this._config.parent }\"]`;\n            const children = [].slice.call(parent.querySelectorAll(selector));\n            $(children).each((i, element) => {\n                this._addAriaAndCollapsedClass(Collapse._getTargetFromElement(element), [element]);\n            });\n            return parent;\n        }\n        _addAriaAndCollapsedClass(element, triggerArray) {\n            const isOpen = $(element).hasClass(ClassName.SHOW);\n            if (triggerArray.length) {\n                $(triggerArray).toggleClass(ClassName.COLLAPSED, !isOpen).attr('aria-expanded', isOpen);\n            }\n        }\n        static _getTargetFromElement(element) {\n            const selector = Util.getSelectorFromElement(element);\n            return selector ? document.querySelector(selector) : null;\n        }\n        static _jqueryInterface(config) {\n            return this.each(function () {\n                const $this = $(this);\n                let data = $this.data(DATA_KEY);\n                //const _config = {\n                //    ...Default,\n                //    ...$this.data(),\n                //    ...typeof config === 'object' && config ? config : {}\n                //};\n                const _config = langx.mixin({},Default,$this.data(),typeof config === 'object' && config ? config : {});\n\n                if (!data && _config.toggle && /show|hide/.test(config)) {\n                    _config.toggle = false;\n                }\n                if (!data) {\n                    data = new Collapse(this, _config);\n                    $this.data(DATA_KEY, data);\n                }\n                if (typeof config === 'string') {\n                    if (typeof data[config] === 'undefined') {\n                        throw new TypeError(`No method named \"${ config }\"`);\n                    }\n                    data[config]();\n                }\n            });\n        }\n    }\n    $(document).on(Event.CLICK_DATA_API, Selector.DATA_TOGGLE, function (event) {\n        if (event.currentTarget.tagName === 'A') {\n            event.preventDefault();\n        }\n        const $trigger = $(this);\n        const selector = Util.getSelectorFromElement(this);\n        const selectors = [].slice.call(document.querySelectorAll(selector));\n        $(selectors).each(function () {\n            const $target = $(this);\n            const data = $target.data(DATA_KEY);\n            const config = data ? 'toggle' : $trigger.data();\n            Collapse._jqueryInterface.call($target, config);\n        });\n    });\n    $.fn[NAME] = Collapse._jqueryInterface;\n    $.fn[NAME].Constructor = Collapse;\n    $.fn[NAME].noConflict = () => {\n        $.fn[NAME] = jquery_NO_CONFLICT;\n        return Collapse._jqueryInterface;\n    };\n    return Collapse;\n});"]}