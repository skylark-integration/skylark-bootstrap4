/**
 * skylark-bootstrap4 - The skylark bootstrap4 component library
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-bootstrap4/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-utils-dom/query","skylark-utils-dom/eventer","skylark-utils-dom/plugins","./bs4","skylark-ui-popper/Popper","./util"],function(t,e,i,n,s,o,r){"use strict";const l="tooltip",a="4.1.3",h="bs.tooltip",c=`.${h}`,g=e.fn[l],u="bs-tooltip",m=new RegExp(`(^|\\s)${u}\\S+`,"g"),p={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)"},d={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},f={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent"},E={SHOW:"show",OUT:"out"},_={HIDE:`hide${c}`,HIDDEN:`hidden${c}`,SHOW:`show${c}`,SHOWN:`shown${c}`,INSERTED:`inserted${c}`,CLICK:`click${c}`,FOCUSIN:`focusin${c}`,FOCUSOUT:`focusout${c}`,MOUSEENTER:`mouseenter${c}`,MOUSELEAVE:`mouseleave${c}`},T={FADE:"fade",SHOW:"show"},v={TOOLTIP:".tooltip",TOOLTIP_INNER:".tooltip-inner",ARROW:".arrow"},C={HOVER:"hover",FOCUS:"focus",CLICK:"click",MANUAL:"manual"};class y{constructor(t,e){if(void 0===o)throw new TypeError("Bootstrap's tooltips require skylark-ui-popper/Popper (https://skylark-ui-popper/Popper.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}static get VERSION(){return a}static get Default(){return f}static get NAME(){return l}static get DATA_KEY(){return h}static get Event(){return _}static get EVENT_KEY(){return c}static get DefaultType(){return p}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(t){if(this._isEnabled)if(t){const i=this.constructor.DATA_KEY;let n=e(t.currentTarget).data(i);n||(n=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(i,n)),n._activeTrigger.click=!n._activeTrigger.click,n._isWithActiveTrigger()?n._enter(null,n):n._leave(null,n)}else{if(e(this.getTipElement()).hasClass(T.SHOW))return void this._leave(null,this);this._enter(null,this)}}dispose(){clearTimeout(this._timeout),e.removeData(this.element,this.constructor.DATA_KEY),e(this.element).off(this.constructor.EVENT_KEY),e(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&e(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,null!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null}show(){if("none"===e(this.element).css("display"))throw new Error("Please use show on visible elements");const t=i.create(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){e(this.element).trigger(t);const i=r.findShadowRoot(this.element),n=e.contains(null!==i?i:this.element.ownerDocument.documentElement,this.element);if(t.isDefaultPrevented()||!n)return;const s=this.getTipElement(),l=r.getUID(this.constructor.NAME);s.setAttribute("id",l),this.element.setAttribute("aria-describedby",l),this.setContent(),this.config.animation&&e(s).addClass(T.FADE);const a="function"==typeof this.config.placement?this.config.placement.call(this,s,this.element):this.config.placement,h=this._getAttachment(a);this.addAttachmentClass(h);const c=this._getContainer();e(s).data(this.constructor.DATA_KEY,this),e.contains(this.element.ownerDocument.documentElement,this.tip)||e(s).appendTo(c),e(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new o(this.element,s,{placement:h,modifiers:{offset:{offset:this.config.offset},flip:{behavior:this.config.fallbackPlacement},arrow:{element:v.ARROW},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:t=>{t.originalPlacement!==t.placement&&this._handlePopperPlacementChange(t)},onUpdate:t=>this._handlePopperPlacementChange(t)}),e(s).addClass(T.SHOW),"ontouchstart"in document.documentElement&&e(document.body).children().on("mouseover",null,e.noop);const g=()=>{this.config.animation&&this._fixTransition();const t=this._hoverState;this._hoverState=null,e(this.element).trigger(this.constructor.Event.SHOWN),t===E.OUT&&this._leave(null,this)};if(e(this.tip).hasClass(T.FADE)){const t=r.getTransitionDurationFromElement(this.tip);e(this.tip).one(r.TRANSITION_END,g).emulateTransitionEnd(t)}else g()}}hide(t){const n=this.getTipElement(),s=i.create(this.constructor.Event.HIDE),o=()=>{this._hoverState!==E.SHOW&&n.parentNode&&n.parentNode.removeChild(n),this._cleanTipClass(),this.element.removeAttribute("aria-describedby"),e(this.element).trigger(this.constructor.Event.HIDDEN),null!==this._popper&&this._popper.destroy(),t&&t()};if(e(this.element).trigger(s),!s.isDefaultPrevented()){if(e(n).removeClass(T.SHOW),"ontouchstart"in document.documentElement&&e(document.body).children().off("mouseover",null,e.noop),this._activeTrigger[C.CLICK]=!1,this._activeTrigger[C.FOCUS]=!1,this._activeTrigger[C.HOVER]=!1,e(this.tip).hasClass(T.FADE)){const t=r.getTransitionDurationFromElement(n);e(n).one(r.TRANSITION_END,o).emulateTransitionEnd(t)}else o();this._hoverState=""}}update(){null!==this._popper&&this._popper.scheduleUpdate()}isWithContent(){return Boolean(this.getTitle())}addAttachmentClass(t){e(this.getTipElement()).addClass(`${u}-${t}`)}getTipElement(){return this.tip=this.tip||e(this.config.template)[0],this.tip}setContent(){const t=this.getTipElement();this.setElementContent(e(t.querySelectorAll(v.TOOLTIP_INNER)),this.getTitle()),e(t).removeClass(`${T.FADE} ${T.SHOW}`)}setElementContent(t,i){const n=this.config.html;"object"==typeof i&&(i.nodeType||i.skylark-utils-dom/query)?n?e(i).parent().is(t)||t.empty().append(i):t.text(e(i).text()):t[n?"html":"text"](i)}getTitle(){let t=this.element.getAttribute("data-original-title");return t||(t="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),t}_getContainer(){return!1===this.config.container?document.body:r.isElement(this.config.container)?e(this.config.container):e(document).find(this.config.container)}_getAttachment(t){return d[t.toUpperCase()]}_setListeners(){this.config.trigger.split(" ").forEach(t=>{if("click"===t)e(this.element).on(this.constructor.Event.CLICK,this.config.selector,t=>this.toggle(t));else if(t!==C.MANUAL){const i=t===C.HOVER?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,n=t===C.HOVER?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;e(this.element).on(i,this.config.selector,t=>this._enter(t)).on(n,this.config.selector,t=>this._leave(t))}}),e(this.element).closest(".modal").on("hide.bs.modal",()=>{this.element&&this.hide()}),this.config.selector?t.mixin(this.config,{trigger:"manual",selector:""}):this._fixTitle()}_fixTitle(){const t=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==t)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))}_enter(t,i){const n=this.constructor.DATA_KEY;(i=i||e(t.currentTarget).data(n))||(i=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(n,i)),t&&(i._activeTrigger["focusin"===t.type?C.FOCUS:C.HOVER]=!0),e(i.getTipElement()).hasClass(T.SHOW)||i._hoverState===E.SHOW?i._hoverState=E.SHOW:(clearTimeout(i._timeout),i._hoverState=E.SHOW,i.config.delay&&i.config.delay.show?i._timeout=setTimeout(()=>{i._hoverState===E.SHOW&&i.show()},i.config.delay.show):i.show())}_leave(t,i){const n=this.constructor.DATA_KEY;(i=i||e(t.currentTarget).data(n))||(i=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(n,i)),t&&(i._activeTrigger["focusout"===t.type?C.FOCUS:C.HOVER]=!1),i._isWithActiveTrigger()||(clearTimeout(i._timeout),i._hoverState=E.OUT,i.config.delay&&i.config.delay.hide?i._timeout=setTimeout(()=>{i._hoverState===E.OUT&&i.hide()},i.config.delay.hide):i.hide())}_isWithActiveTrigger(){for(const t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1}_getConfig(i){return"number"==typeof(i=t.mixin({},this.constructor.Default,e(this.element).data(),i)).delay&&(i.delay={show:i.delay,hide:i.delay}),"number"==typeof i.title&&(i.title=i.title.toString()),"number"==typeof i.content&&(i.content=i.content.toString()),r.typeCheckConfig(l,i,this.constructor.DefaultType),i}_getDelegateConfig(){const t={};if(this.config)for(const e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t}_cleanTipClass(){const t=e(this.getTipElement()),i=t.attr("class").match(m);null!==i&&i.length&&t.removeClass(i.join(""))}_handlePopperPlacementChange(t){const e=t.instance;this.tip=e.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))}_fixTransition(){const t=this.getTipElement(),i=this.config.animation;null===t.getAttribute("x-placement")&&(e(t).removeClass(T.FADE),this.config.animation=!1,this.hide(),this.show(),this.config.animation=i)}static _jqueryInterface(t){return this.each(function(){let i=e(this).data(h);const n="object"==typeof t&&t;if((i||!/dispose|hide/.test(t))&&(i||(i=new y(this,n),e(this).data(h,i)),"string"==typeof t)){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}})}}return e.fn[l]=y._jqueryInterface,e.fn[l].Constructor=y,e.fn[l].noConflict=(()=>(e.fn[l]=g,y._jqueryInterface)),y});
//# sourceMappingURL=sourcemaps/tooltip.js.map
